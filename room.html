<!DOCTYPE html>
<html>

<head>

  <title>Realtime communication with WebRTC</title>

  <link rel="stylesheet" href="/css/main.css" />

</head>

<body>

  <h1>Realtime communication with WebRTC</h1>

  <div id="videos">
    <video id="localVideo" autoplay muted playsinline></video>
    <video id="remoteVideo" autoplay playsinline></video>    
  </div>

  <div id="chat">
    <h2>Chat</h2>
    <div id="trail"></div>
  </div>

  <script src="https://cdn.webrtc-experiment.com/MediaStreamRecorder.js"> </script>
  <script>
  var mediaConstraints = {
      audio: true,
      video: true
  };
  
  navigator.getUserMedia(mediaConstraints, onMediaSuccess, onMediaError);
  
  function onMediaSuccess(stream) {
      var mediaRecorder = new MediaStreamRecorder(stream);
      mediaRecorder.mimeType = 'video/webm';
      mediaRecorder.ondataavailable = function (blob) {
          // POST/PUT "Blob" using FormData/XHR2
          var blobURL = URL.createObjectURL(blob);
          document.write('<a href="' + blobURL + '">' + blobURL + '</a>');
      };
      mediaRecorder.start(3000);
  }
  
  function onMediaError(e) {
      console.error('media error', e);
  }
  </script>

  <!-- This file is automatically added/served when running "node index.js". -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
  <script src="js/main.js"></script>

</body>

</html>